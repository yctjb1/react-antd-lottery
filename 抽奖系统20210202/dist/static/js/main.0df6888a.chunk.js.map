{"version":3,"sources":["pages/HomePage/index.tsx","components/SettingModal.tsx","pages/router.tsx","App.tsx","serviceWorker.ts","index.tsx","utils/handleExcel.ts"],"names":["Option","Select","getRandomInt","min","max","Math","ceil","floor","random","props","useState","tcRunning","settingModal","tcOptions","setTCOptions","awards","awardlevel","awardname","awardnum","key","currentAwardKey","currentAwardLeft","awardOptions","setAwardOptions","awardeePlayers","members","usercode","username","currentplayers","memberOptions","setMemberOptions","reducemode","shownowresult","active_resultsNumber","result","lotterOptions","setLotterOptions","useEffect","queryLocalStorage","Object","assign","maxNum","createOption","updateCurrentAwardLeft","initTC","str","eval","changeSpeed","status","handleSettingModal","backFromChild","new_awardOptions","new_memberOptions","resetFlag","filter","item","prevMembers","newMembers","prevAwards","newAwards","diffMembers","differenceWith","isEqual","diffAwards","deleteAwards","special_delete_awardKeys","delete_awardKeys","map","prevAward","newAward","push","new_lotterOptions","JSON","parse","stringify","index","indexOf","awardKey","awardeeArr","intersectionWith","now_result_item","exist_num","length","Number","handleChangeAward","val","newindex","data","handleStop","maxAwardNum","leftAwardNum","maxMembers","leftplayersNumber","now_awardIndex","new_result","result_prev_awardees","RANDOM_NUM","random_num","console","log","new_awardeePlayers","i","new_awardeeIndex","new_awardee","batch_prev_awardees","splice","new_tcOptions","updateLocalStorage","handleClear","mode","handleReduceMode","reduceNum","flag","allState","localStorage","removeItem","setItem","react_antd_lottery","getItem","undefined","handleExport","export_json","result_item","award","exportExcel","arr","LeftPart","className","value","style","width","disabled","onChange","title","checkedChildren","unCheckedChildren","checked","onClick","borderRadius","icon","display","placeItems","slice","placement","marginRight","size","type","downloadTemplate","RightPart","currentPageData","columns","dataIndex","dataSource","rowKey","record","pagination","scroll","y","BodyPart","id","height","document","documentElement","clientHeight","clientWidth","href","target","color","background","backgroundSize","backgroundRepeat","gridTemplate","gridColumn","tcOptions_settingModal","wrap","placeContent","TabPane","Tabs","SettingModal","activePane","setActivePane","upLoadStatus","setUpLoadStatus","awardColumns","render","text","e","updateInputValue","danger","palyerColumns","statename","rowindex","repeat_flag","exist_comb","Array","from","Set","message","warning","paddingTop","visible","onCancel","footer","activeKey","tabBarExtraContent","newkey","concat","addRow","tab","accept","e_target","persist","importExcel","then","addMembers","usercode_arr","prev_member","exist_comb_record","new_exist_comb_record","new_comb","catch","PageMainRouter","exact","to","path","component","HomePage","App","Boolean","window","location","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister","error","Promise","resolve","wb","files","firstfile","reader","FileReader","onload","XLSX","read","josonarray","utils","sheet_to_json","Sheets","SheetNames","readAsBinaryString","SheetNames_array","keys","json_to_sheet","Props","write","bookType","compression","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","createElement","download","blob","Blob","URL","createObjectURL","body","appendChild","click","removeChild"],"mappings":"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","file":"static/js/main.0df6888a.chunk.js","sourcesContent":["import React, { Fragment, useEffect, useState } from 'react';\r\nimport { Button, Table, Switch, Select, message, Tooltip, Space } from 'antd';\r\nimport SettingModal from '@components/SettingModal';\r\nimport {\r\n    PlayCircleOutlined, PauseCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { exportExcel, downloadTemplate } from \"@utils/handleExcel\"\r\nimport differenceWith from 'lodash/differenceWith';\r\nimport intersectionWith from 'lodash/intersectionWith';\r\nimport isEqual from 'lodash/isEqual';\r\nimport \"./index.less\"\r\nimport { result } from 'lodash';\r\nconst { Option } = Select;\r\n\r\ninterface AwardOptionType {\r\n    awards: object[],\r\n    currentAwardKey: string | number,\r\n    currentAwardLeft: string | number\r\n}\r\n\r\ninterface ResultType {\r\n    awardKey: string | number,\r\n    awardeeArr: AwardType[],\r\n}\r\n\r\ninterface AwardType {\r\n    awardlevel: string,\r\n    awardname: string,\r\n    awardnum: string | number,\r\n    key: string | number\r\n}\r\n\r\n\r\n\r\nconst getRandomInt = (min: any, max: any) => { //本函数在min和max之间取一个整数随机数(包头包尾)\r\n    min = Math.ceil(min);//Math.ceil() 函数返回大于或等于一个给定数字的最小整数\r\n    max = Math.floor(max);//Math.floor() 返回小于或等于一个给定数字的最大整数\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\n\r\nexport default (props: any) => {\r\n    const [tcOptions, setTCOptions] = useState({\r\n        tcRunning: false,\r\n        settingModal: false\r\n    });//是否在旋转\r\n    //tagcanvas的参数\r\n    const [awardOptions, setAwardOptions] = useState({\r\n        awards: [\r\n            { awardlevel: \"一等奖\", awardname: \"摩托\", awardnum: 1, key: \"1\" },\r\n            { awardlevel: \"二等奖\", awardname: \"单车\", awardnum: 2, key: \"2\" }\r\n        ],//localStorage的awards所有奖项数组\r\n        currentAwardKey: \"1\",//当前奖项在localStorage的awards所有奖项数组中的key\r\n        currentAwardLeft: 0,//当前奖项剩余数量\r\n    });//抽奖的设置参数-奖\r\n\r\n    const [memberOptions, setMemberOptions] = useState({\r\n        // players: [],//剩余总人数 ->分组后的剩余参与人员\r\n\r\n        // currentPlayersIndex: 1,//当前所在批次(下标+1) 【考虑废弃】\r\n        awardeePlayers: [],//本轮中奖名单\r\n\r\n        members: [{ usercode: \"01\", username: \"测试甲\", key: \"1\" },\r\n        { usercode: \"02\", username: \"测试乙\", key: \"2\" }],//总人数\r\n\r\n        // batchNumber: 10,//每轮人数原本分批，现在【设置一次后】固定不变了 【考虑废弃】\r\n        currentplayers: [],//当前总人数\r\n\r\n        //leftplayersNumber: 10//剩余参与人数 【废弃】\r\n\r\n    })//抽奖的设置参数-人\r\n\r\n    const [lotterOptions, setLotterOptions] = useState({\r\n        reducemode: true,//剔除中奖人模式\r\n        shownowresult: false,//开关展示当前奖项已经出来的结果\r\n        active_resultsNumber: 0,//指定抽中奖人数 --初值等于最大奖品数\r\n        result: [],//中奖结果 [awardKey,awardeeArr]\r\n\r\n    })//抽奖的设置参数-配置\r\n\r\n    useEffect(() => {\r\n        if (queryLocalStorage()) {\r\n\r\n        } else {\r\n            setMemberOptions(Object.assign({}, memberOptions, { currentplayers: memberOptions.members }))\r\n            let maxNum = createOption(awardOptions)[0];\r\n            setLotterOptions(Object.assign({}, lotterOptions, { active_resultsNumber: maxNum }))\r\n            updateCurrentAwardLeft()\r\n        }\r\n\r\n        initTC()\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n\r\n        // eval(\r\n        //     `TagCanvas.Reload('myCanvas');\r\n        //     `\r\n        // );\r\n        if (tcOptions.tcRunning) {\r\n            initTC(\"TagCanvas.SetSpeed('myCanvas', [5, 1]);TagCanvas.Reload('myCanvas')\")\r\n        } else {\r\n\r\n            initTC()\r\n        }\r\n\r\n    }, [tcOptions.tcRunning, memberOptions, tcOptions.settingModal, awardOptions, lotterOptions])\r\n\r\n    //方法区\r\n    const initTC = (str?: string) => {\r\n        eval(\r\n            `try {\r\n             TagCanvas.Start(\r\n               'myCanvas',\r\n               '',\r\n               {textColour: null,\r\n                dragControl: 1,\r\n                decel: 0.95,\r\n                textHeight: 14,\r\n                minSpeed: 0.01,\r\n                initial: [\r\n                  0.1 * Math.random() + 0.01,\r\n                  -(0.1 * Math.random() + 0.01),\r\n                ]\r\n            });\r\n            ${!str ? \"\" : str}\r\n           }\r\n           catch(e) {\r\n             document.getElementById('myCanvasContainer').style.display = 'none';\r\n           }`\r\n        );\r\n    }\r\n    const changeSpeed = (status: string) => {\r\n        if (status === \"start\") {\r\n\r\n            setTCOptions(Object.assign({}, tcOptions, { tcRunning: true }))\r\n        } else if (status === \"stop\") {\r\n\r\n            setTCOptions(Object.assign({}, tcOptions, { tcRunning: false }))\r\n        }\r\n\r\n    }\r\n\r\n    const handleSettingModal = (status: boolean) => {\r\n        setTCOptions(Object.assign({}, tcOptions, { settingModal: status }))\r\n    }\r\n\r\n    const backFromChild = (new_awardOptions: any, new_memberOptions: any, resetFlag: boolean) => {\r\n        //剔除某项为空的数据\r\n        new_awardOptions.awards = new_awardOptions.awards.filter((item: any) => {\r\n            if (!item.awardlevel || !item.awardname || !item.awardnum) return false; else return true;\r\n        })\r\n        new_memberOptions.members = new_memberOptions.members.filter((item: any) => {\r\n            if (!item.usercode || !item.username) return false; else return true;\r\n        })\r\n\r\n\r\n\r\n\r\n\r\n\r\n        const prevMembers = memberOptions.members;\r\n        const newMembers = new_memberOptions.members\r\n        const prevAwards = awardOptions.awards\r\n        const newAwards = new_awardOptions.awards\r\n\r\n        let diffMembers = differenceWith(prevMembers, newMembers, isEqual);\r\n        let diffAwards = differenceWith(prevAwards, newAwards, isEqual);\r\n        let deleteMembers = differenceWith(prevMembers, diffMembers, isEqual);\r\n        let addMembers = differenceWith(newMembers, diffMembers, isEqual);\r\n        let deleteAwards = differenceWith(prevAwards, diffAwards, isEqual);\r\n        let addAwards = differenceWith(prevAwards, diffAwards, isEqual);\r\n\r\n\r\n\r\n\r\n        /*\r\n       【无论是否重置】\r\n        (1)如果全部清空，会出现相同的key，出现相同的key但是awardlevel+awardname不同视为删除，清空result中该奖结果。\r\n        (2)总奖池:剔除diffAwards,其他已经有的不去动,添加addAwards =>直接使用新值\r\n        (3)总人数:剔除diffMembers,其他已经有的不去动，添加addMembers =>直接使用新值\r\n        (4)已中奖的名单里,除了(1)的操作，也要剔除diffMembers  =>与new的总名单取交集\r\n\r\n        清空awardeePlayers本轮中奖名单\r\n        更新当前奖项剩余数量\r\n\r\n        【不重置】\r\n        啥也不做\r\n\r\n        【重置】\r\n        清空奖项\r\n        剩余的参数人数重置\r\n         */\r\n\r\n        //(1)\r\n        let special_delete_awardKeys: string[] = [];\r\n        let delete_awardKeys: string[] = deleteAwards.map((item: any) => item.key);\r\n        prevAwards.map((prevAward: any) => {\r\n            newAwards.map((newAward: any) => {\r\n                if (prevAward.key === newAward.key) {\r\n                    if (prevAward.awardlevel !== newAward.awardlevel && prevAward.awardname !== newAward.awardname) {\r\n                        special_delete_awardKeys.push(prevAward.key);\r\n                    }\r\n                }\r\n            })\r\n        })\r\n        let new_lotterOptions = JSON.parse(JSON.stringify(lotterOptions));\r\n        new_lotterOptions.result.map((item: any, index: any) => {\r\n            if (special_delete_awardKeys.indexOf(item.awardKey) > -1\r\n                || delete_awardKeys.indexOf(item.awardKey) > -1) {\r\n                delete new_lotterOptions.result[index]\r\n            }\r\n        })\r\n        new_lotterOptions.result = new_lotterOptions.result.filter((item: any) => item)\r\n        //(4)\r\n        new_lotterOptions.result = new_lotterOptions.result.map((item: any) => {\r\n            item.awardeeArr = intersectionWith(item.awardeeArr, newMembers, isEqual);\r\n        })\r\n        new_memberOptions.awardeePlayers = [];\r\n\r\n        //更新剩余数量\r\n        let currentAwardLeft = 0;\r\n        let now_result_item: ResultType[] = new_lotterOptions.result.filter((item: any) => item?.awardKey == new_awardOptions.currentAwardKey);\r\n        let exist_num = now_result_item.length ? now_result_item[0].awardeeArr.length : 0;\r\n        new_awardOptions.awards.map((item: any) => {\r\n            if (item.key === new_awardOptions.currentAwardKey) {\r\n                currentAwardLeft = Number(item.awardnum);\r\n            }\r\n            currentAwardLeft -= exist_num;\r\n        })\r\n        new_awardOptions.currentAwardLeft = currentAwardLeft;\r\n\r\n\r\n\r\n        if (resetFlag) {//重置\r\n            new_lotterOptions.result = [];\r\n            new_memberOptions.currentplayers = new_memberOptions.members;\r\n        } else {//不重置\r\n\r\n        }\r\n\r\n        handleSettingModal(false)\r\n        setAwardOptions(new_awardOptions)\r\n        setMemberOptions(new_memberOptions)\r\n        setLotterOptions(new_lotterOptions)\r\n    }\r\n\r\n    const handleChangeAward = (val: any) => {\r\n\r\n\r\n        //清空当前中奖者\r\n        setMemberOptions(Object.assign({}, memberOptions, { awardeePlayers: [] }))\r\n\r\n        let currentAwardKey: any, new_awardOptions: any;\r\n\r\n\r\n\r\n\r\n\r\n        if (val === \"next\") {\r\n            let newindex = -1;\r\n            let data = awardOptions.awards;\r\n            data.map((item: any, index: any) => {\r\n                if (item.key === awardOptions.currentAwardKey) {\r\n                    newindex = index + 1\r\n                }\r\n            })\r\n\r\n            if (newindex > -1 && newindex <= data.length - 1) {\r\n\r\n                currentAwardKey = data[newindex].key;\r\n            } else {\r\n                return\r\n            }\r\n        } else {\r\n            currentAwardKey = val;\r\n        }\r\n\r\n\r\n        //更新剩余数量【得手动写一份】\r\n        let currentAwardLeft = 0;\r\n        let now_result_item: ResultType[] = lotterOptions.result.filter((item: any) => item.awardKey == currentAwardKey);\r\n        let exist_num = now_result_item.length ? now_result_item[0].awardeeArr.length : 0;\r\n        awardOptions.awards.map((item: any) => {\r\n            if (item.key === currentAwardKey) {\r\n                currentAwardLeft = Number(item.awardnum);\r\n            }\r\n            currentAwardLeft -= exist_num;\r\n        })\r\n        new_awardOptions = Object.assign({}, awardOptions, { currentAwardKey, currentAwardLeft });\r\n\r\n        //每次切换，设置的中奖人数重置为最大值\r\n        let maxNum = createOption(new_awardOptions)[0];\r\n        setLotterOptions(Object.assign({}, lotterOptions, { active_resultsNumber: maxNum }))\r\n\r\n        setAwardOptions(new_awardOptions)\r\n\r\n\r\n    }\r\n    const handleStop = () => {\r\n\r\n        let active_resultsNumber = lotterOptions.active_resultsNumber//本轮设置的中奖人数\r\n\r\n        const maxAwardNum = createOption(awardOptions)[0];//当前奖品最大数量\r\n        const leftAwardNum = awardOptions.currentAwardLeft   //当前奖项剩余数量\r\n        let temp_leftAwardNum = leftAwardNum;\r\n        let maxMembers = JSON.parse(JSON.stringify(memberOptions.members));//总名单\r\n        let currentplayers = JSON.parse(JSON.stringify(memberOptions.currentplayers));//剩余名单\r\n\r\n        let leftplayersNumber = lotterOptions.reducemode ? currentplayers.length : maxMembers.length;//剩下的参与人数\r\n\r\n        let now_awardIndex = -1;//当前奖项key所在result中下标\r\n\r\n        let new_result: ResultType[] = JSON.parse(JSON.stringify(lotterOptions.result))\r\n        let result_prev_awardees: any[] = [];//各个奖项的已中奖者名单\r\n        new_result.length && new_result.map((item: any, index: any) => {\r\n            if (item.awardKey === awardOptions.currentAwardKey) {\r\n                now_awardIndex = index;\r\n            }\r\n            result_prev_awardees.push(...item.awardeeArr)\r\n        })\r\n\r\n\r\n\r\n\r\n        //实际获取随机数的次数\r\n        const RANDOM_NUM = Math.min(active_resultsNumber, maxAwardNum, leftAwardNum, leftplayersNumber);\r\n\r\n        let random_num = RANDOM_NUM;\r\n        console.log(\"受控的理论真正中奖者数量:\" + RANDOM_NUM)\r\n        let new_awardeePlayers: any[] = [];//本轮中奖名单\r\n        for (let i = 0; i < random_num && new_awardeePlayers.length < active_resultsNumber; i++) {\r\n\r\n            let new_awardeeIndex = getRandomInt(0, leftplayersNumber - 1);\r\n            let new_awardee = lotterOptions.reducemode ? currentplayers[new_awardeeIndex] : maxMembers[new_awardeeIndex];\r\n            // 打印参数\r\n            // console.log(`中奖者下标=${new_awardeeIndex},中奖者名字=${new_awardee?.username},中奖者key=${new_awardee?.key},new_awardeePlayers=${JSON.stringify(new_awardeePlayers)}`)\r\n\r\n            if (JSON.stringify(new_awardeePlayers).indexOf(JSON.stringify(new_awardee)) > -1) {//如果在本轮中奖名单里重复\r\n                random_num += 1;//继续抽一次\r\n\r\n\r\n            } else {\r\n\r\n                let batch_prev_awardees = now_awardIndex > -1 ? new_result[now_awardIndex][\"awardeeArr\"] : [];//如果该奖已经抽过，则传入已经存在的中奖者\r\n\r\n                //无论是否是剔除模式，确保每轮抽奖里一个人的名字只会出现一次、同一个奖项里一个人的名字也只出现一次\r\n\r\n                if (JSON.stringify(batch_prev_awardees).indexOf(JSON.stringify(new_awardee)) > -1) {//如果已经在当前奖项的中奖者里面\r\n\r\n                    random_num += 1;//继续抽一次\r\n\r\n                } else if (JSON.stringify(result_prev_awardees).indexOf(JSON.stringify(new_awardee)) > -1) {//如果中过别的奖\r\n\r\n                    if (lotterOptions.reducemode) {//剔除模式--剔除模式下如果进了这分支就是有逻辑写错了\r\n\r\n                        random_num += 1;//继续抽一次\r\n                    } else {//非剔除模式\r\n                        new_awardeePlayers.push(new_awardee)\r\n                        temp_leftAwardNum--;\r\n\r\n                    }\r\n                } else {\r\n                    new_awardeePlayers.push(new_awardee);\r\n                    temp_leftAwardNum--;\r\n                    leftplayersNumber--;\r\n                    lotterOptions.reducemode && currentplayers.splice(new_awardeeIndex, 1)//从抽奖名单中拿掉\r\n                    console.log(`剔除了一次，并查看新的new_awardeeIndex = ${new_awardeeIndex},currentplayers=`)\r\n                    console.log(currentplayers)\r\n                }\r\n\r\n\r\n\r\n                // //如果剩余奖品不为0、而且当前轮中奖数量没达到要求、并且人数还够,则继续抽一次\r\n                // if (leftAwardNum > 0 && currentplayers.length > 0) {\r\n                //     random_num += 1;\r\n                // }\r\n            }\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        if (now_awardIndex > -1) {\r\n            new_result[now_awardIndex]?.awardeeArr.push(...new_awardeePlayers)\r\n        } else {\r\n            new_result.push({ awardKey: awardOptions.currentAwardKey, awardeeArr: new_awardeePlayers })\r\n        }\r\n\r\n\r\n        let new_memberOptions;//state1\r\n        if (lotterOptions.reducemode) {\r\n            new_memberOptions = Object.assign({}, memberOptions, { currentplayers, awardeePlayers: new_awardeePlayers })\r\n            setMemberOptions(new_memberOptions)//剔除模式就更新剩余名单\r\n        } else {\r\n            new_memberOptions = Object.assign({}, memberOptions, { awardeePlayers: new_awardeePlayers })\r\n            setMemberOptions(new_memberOptions)\r\n\r\n        }\r\n\r\n        let new_lotterOptions = Object.assign({}, lotterOptions, {\r\n            shownowresult: true,\r\n            result: new_result\r\n        })//state2\r\n        setLotterOptions(new_lotterOptions)\r\n\r\n        //确保新数据能更新到localStorage，得提前封装一份，所以改成手动再写一遍更新剩余数量\r\n        // updateCurrentAwardLeft(awardOptions.currentAwardKey, RANDOM_NUM)//更新该奖剩余数量\r\n\r\n        let new_awardOptions = Object.assign({}, awardOptions, { currentAwardLeft: maxAwardNum - new_awardeePlayers.length });//state3\r\n        setAwardOptions(new_awardOptions)\r\n\r\n        let new_tcOptions = Object.assign({}, tcOptions, { tcRunning: false });//state4\r\n        setTCOptions(new_tcOptions);//停止旋转\r\n\r\n        //更新localStorage\r\n        updateLocalStorage(\"updateAll\", {\r\n            tcOptions: new_tcOptions,\r\n            awardOptions: new_awardOptions,\r\n            memberOptions: new_memberOptions,\r\n            lotterOptions: new_lotterOptions\r\n        })\r\n\r\n    }\r\n\r\n    const handleClear = (mode: string, reducemode?: boolean) => {\r\n        if (mode === \"all\") {\r\n\r\n            setMemberOptions(Object.assign({}, memberOptions, { currentplayers: memberOptions.members, awardeePlayers: [] }));\r\n            let new_lotterOptions = Object.assign({}, lotterOptions, {\r\n                shownowresult: false,\r\n                reducemode: reducemode || false,\r\n                result: []\r\n            })\r\n\r\n            setLotterOptions(new_lotterOptions)\r\n            updateCurrentAwardLeft(awardOptions.currentAwardKey, 0, new_lotterOptions)\r\n            updateLocalStorage(\"clearAll\")\r\n        }\r\n    }\r\n\r\n    const handleReduceMode = (val: boolean) => {\r\n        // setLotterOptions(Object.assign({}, lotterOptions, { reducemode: val }))\r\n        handleClear(\"all\", val)//重置\r\n    }\r\n\r\n    const updateCurrentAwardLeft = (awardKey?: any, reduceNum?: any, new_lotterOptions?: any) => {\r\n        let currentAwardKey = awardKey || \"1\";\r\n        let currentAwardLeft = 0;\r\n        let now_result_item: ResultType[] = (new_lotterOptions || lotterOptions).result.filter((item: any) => item.awardKey === currentAwardKey);\r\n        let exist_num = now_result_item.length ? now_result_item[0].awardeeArr.length : 0;\r\n        awardOptions.awards.map((item: any) => {\r\n            if (item.key === currentAwardKey) {\r\n                currentAwardLeft = Number(item.awardnum);\r\n\r\n                if (reduceNum) {\r\n                    currentAwardLeft -= reduceNum;\r\n                }\r\n                currentAwardLeft -= exist_num;\r\n\r\n            }\r\n        })\r\n\r\n        setAwardOptions(Object.assign({}, awardOptions, { currentAwardLeft }))\r\n    }\r\n\r\n    const updateLocalStorage = (flag: string, allState?: any) => {\r\n        if (flag && flag === \"clearAll\") {\r\n            localStorage.removeItem(\"react_antd_lottery\");\r\n        } else {\r\n\r\n            localStorage.setItem(\"react_antd_lottery\", JSON.stringify(allState));\r\n        }\r\n\r\n    }\r\n\r\n    const queryLocalStorage = (): boolean => {\r\n        let react_antd_lottery: any = localStorage.getItem(\"react_antd_lottery\") || undefined;\r\n        if (react_antd_lottery) {\r\n            react_antd_lottery = JSON.parse(react_antd_lottery)\r\n            setTCOptions(react_antd_lottery.tcOptions)\r\n            setAwardOptions(react_antd_lottery.awardOptions)\r\n            setMemberOptions(react_antd_lottery.memberOptions)\r\n            setLotterOptions(react_antd_lottery.lotterOptions)\r\n            return true\r\n        } else {\r\n\r\n            return false\r\n        }\r\n    }\r\n\r\n    const handleExport = () => {\r\n        const result = lotterOptions.result;\r\n        const awards = awardOptions.awards;\r\n        let export_json: any = []\r\n        result.map((result_item: any) => {\r\n            let award = awards.filter((item: any) => item.key === result_item.awardKey)[0]\r\n            export_json[award.awardlevel] = result_item.awardeeArr;\r\n        })\r\n        exportExcel(export_json);\r\n    }\r\n\r\n    //UI组件区\r\n    const createOption = (awardOptions: AwardOptionType): number[] => {\r\n        let maxNum = 0;\r\n        awardOptions.awards.map((item: any) => {\r\n            if (item.key === awardOptions.currentAwardKey) {\r\n                maxNum = Number(item.awardnum) < 0 ? 0 : Number(item.awardnum);\r\n            }\r\n        })\r\n\r\n        let arr: number[] = [];\r\n        for (let i = maxNum; arr.push(i--) < maxNum + 1;) { }\r\n        return arr;\r\n    }\r\n\r\n\r\n    const LeftPart = () => <Fragment>\r\n\r\n        <ul className={\"operation_ul\"}>\r\n            <li>奖项:\r\n            <Select value={awardOptions.currentAwardKey} style={{ width: 120 }}\r\n                    disabled={tcOptions.tcRunning}\r\n                    onChange={(value) => handleChangeAward(value)}>\r\n                    {awardOptions.awards.map((item: any) => <Option key={item.key} value={item.key}>\r\n                        {item.awardlevel}\r\n                    </Option>\r\n                    )}\r\n                </Select>\r\n            </li>\r\n            <li>\r\n                <Tooltip title={\"注:切换剔除将重置中奖结果\"}>\r\n                    <Switch disabled={tcOptions.tcRunning}\r\n                        checkedChildren=\"剔除已中奖\" unCheckedChildren=\"保留已中奖\" checked={lotterOptions.reducemode}\r\n                        onChange={(val) => handleReduceMode(val)} />\r\n                        剩余:<b>{memberOptions.currentplayers.length}人</b>\r\n                </Tooltip>\r\n            </li>\r\n            <li>\r\n                {!tcOptions.tcRunning ?\r\n                    <Button onClick={() => changeSpeed(\"start\")}\r\n                        disabled={createOption(awardOptions)[0] <= 0 || awardOptions.currentAwardLeft <= 0 || memberOptions.currentplayers.length === 0}\r\n                        style={{ borderRadius: \"25px 0 0 25px\" }}\r\n                        icon={<PlayCircleOutlined style={{ display: \"inline-grid\", placeItems: \"center\" }} />} >{\r\n                            awardOptions.currentAwardLeft < createOption(awardOptions)[0] ?\r\n                                \"继续\" : \"开始\"\r\n                        }</Button>\r\n                    : <Button onClick={() => handleStop()}\r\n                        style={{ borderRadius: \"25px 0 0 25px\" }}\r\n                        icon={<PauseCircleOutlined style={{ display: \"inline-grid\", placeItems: \"center\" }} />}\r\n                    >停止</Button>\r\n                }\r\n\r\n                <Button style={{ borderRadius: \"0 25px 25px 0\" }}\r\n                    disabled={tcOptions.tcRunning || awardOptions.currentAwardKey === awardOptions.awards.slice(-1)[0].key}\r\n                    onClick={() => handleChangeAward(\"next\")}>下一个奖</Button></li>\r\n            <li>\r\n\r\n                <Tooltip title={\"注:可以选择的范围取决于当前奖品总数\"} placement=\"bottom\">\r\n                    <span>本轮中奖人数</span>\r\n                </Tooltip>\r\n                <Select\r\n                    value={lotterOptions.active_resultsNumber}\r\n                    disabled={tcOptions.tcRunning}\r\n                    onChange={(value) => setLotterOptions(Object.assign({}, lotterOptions, { active_resultsNumber: value }))}>\r\n\r\n                    {createOption(awardOptions).map((item: any) => <Option key={item} value={item}>\r\n                        {item}\r\n                    </Option>\r\n                    )}\r\n                </Select>\r\n\r\n                {/* <br /><span>奖池所剩<b>{awardOptions.currentAwardLeft}</b>个</span> */}\r\n            </li>\r\n            <li>\r\n                <Button style={{ marginRight: 4 }} size=\"small\"\r\n                    disabled={tcOptions.tcRunning}\r\n                    onClick={() => handleSettingModal(true)}>设置</Button>\r\n                <Tooltip title={\"注:重置会连同清空本地存储数据，刷新后会丢失，可以中奖人数设0后抽取一次来记录数据\"} placement=\"bottom\">\r\n                    <Button style={{ marginRight: 4 }} size=\"small\"\r\n                        disabled={tcOptions.tcRunning}\r\n                        onClick={() => handleClear(\"all\", lotterOptions.reducemode)}>重置所有</Button>\r\n                </Tooltip>\r\n            </li>\r\n            <li>\r\n                <Button size=\"small\" disabled={tcOptions.tcRunning || lotterOptions.result.length === 0}\r\n                    onClick={() => handleExport()}>导出全部</Button>\r\n                <Button size=\"small\" type={\"link\"}\r\n                    onClick={() => downloadTemplate()}>下载模板</Button>\r\n            </li>\r\n        </ul>\r\n    </Fragment>\r\n\r\n    const RightPart = () => {\r\n        let result: ResultType = lotterOptions.result.filter((item: any) => item.awardKey === awardOptions.currentAwardKey)[0];\r\n        return <Fragment>\r\n            {\r\n                lotterOptions.shownowresult && result && result?.awardeeArr.length !== 0 ?\r\n                    <Table\r\n                        title={(currentPageData) => \"获奖名单\"}\r\n                        columns={[\r\n                            {\r\n                                dataIndex: 'username',\r\n                                title: '姓名',\r\n                                width: 100,\r\n                            },\r\n                            {\r\n                                dataIndex: 'usercode',\r\n                                title: '编号',\r\n                                width: 100,\r\n                            }\r\n                        ]}\r\n                        dataSource={result?.awardeeArr}\r\n                        rowKey={(record) => record?.key}\r\n                        pagination={false}// 考虑前端分页\r\n                        size={\"small\"}\r\n                        scroll={{ y: 400 }}\r\n                    ></Table>\r\n                    : null\r\n            }\r\n        </Fragment>\r\n    }\r\n\r\n    const BodyPart = () => <div>\r\n        <div id=\"myCanvasContainer\">\r\n            <canvas id=\"myCanvas\" height={document.documentElement.clientHeight - 150} width={document.documentElement.clientWidth - 200 - 250}>\r\n                <p>Anything in here will be replaced on browsers that support the canvas element</p>\r\n                {/* 超出一定数量设定截取渲染 */}\r\n                <ul>\r\n                    {\r\n                        memberOptions.currentplayers.length > 400 ?\r\n                            memberOptions.currentplayers.slice(0, 400).map((item: any, index) => <li key={item.usercode}>\r\n                                <a href=\"#\" target=\"_blank\" style={{ color: \"#fff\" }}>{item.username}</a>\r\n                            </li>)\r\n                            :\r\n                            memberOptions.currentplayers.map((item: any, index) => <li key={item.usercode}>\r\n                                <a href=\"#\" target=\"_blank\" style={{ color: \"#fff\" }}>{item.username}</a>\r\n                            </li>)}\r\n                </ul>\r\n\r\n            </canvas>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    //return区\r\n    return <div style={{\r\n        background: `url(./bg.jpg)`, backgroundSize: \"cover\",\r\n        backgroundRepeat: \"no-repeat\"\r\n    }}>\r\n        {/* 布局 */}\r\n        <div style={{\r\n            display: \"grid\",\r\n            gridTemplate: \"1fr auto / auto 1fr auto\"\r\n        }}>\r\n            <div style={{ gridColumn: \"1/2\", color: \"#fff\", display: \"grid\", placeItems: \"center\" }}>\r\n                <LeftPart />\r\n            </div>\r\n            <div style={{ gridColumn: \"2/3\", height: \"100vh\", color: \"#fff\" }}>\r\n                <BodyPart />\r\n            </div>\r\n            <div style={{ gridColumn: \"3/4\", color: \"#fff\", display: \"grid\", placeItems: \"end center\" }}>\r\n                <RightPart />\r\n            </div>\r\n            <div style={{ gridColumn: \"1/4\", height: \"0vh\", color: \"#fff\", display: \"grid\", placeItems: \"center\" }}>\r\n\r\n                {/* 调试用---把0vh改成有效值，同时变更BodyPart上一级div的vh */}\r\n                {/* 当前最大值：{createOption(awardOptions)[0]}<br />\r\n                当前剩余数量:{awardOptions.currentAwardLeft}<br />\r\n                <Button onClick={() => {\r\n                    console.log(JSON.stringify(memberOptions.currentplayers))\r\n                }}>查看剩余参与者名单</Button> */}\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n        </div>\r\n        {tcOptions.settingModal ?\r\n            <SettingModal\r\n                tcOptions_settingModal={tcOptions.settingModal}\r\n                awardOptions={awardOptions}\r\n                memberOptions={memberOptions}\r\n                handleSettingModal={handleSettingModal}\r\n                backFromChild={backFromChild}\r\n            />\r\n            : null}\r\n\r\n\r\n        {awardOptions.awards.map((item: any) => {\r\n            if (item.key === awardOptions.currentAwardKey) {\r\n                return <div key=\"1\" className=\"showAward\">\r\n                    <b>{item.awardlevel}：{item.awardname}（{awardOptions.currentAwardLeft}/{createOption(awardOptions)[0]}）</b>\r\n                    {/* 本轮中奖名单-展示用 */}\r\n                    <Space size={[8, 16]} wrap style={{\r\n                        width: \"80%\",\r\n                        placeContent: \"center\"\r\n                    }}>\r\n                        {memberOptions.awardeePlayers.map((item: any, index) =>\r\n                            <Button key={index} size={\"large\"}>{item.username}</Button>\r\n                        )}\r\n                    </Space>\r\n                </div>\r\n            }\r\n\r\n        })}\r\n\r\n    </div>\r\n}\r\n\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Input, Tabs, Table, InputNumber, Button, message, Tooltip } from 'antd';\r\nimport {\r\n    PlusCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { importExcel } from \"@utils/handleExcel\"\r\nconst { TabPane } = Tabs;\r\n\r\n\r\n/**\r\n * \r\n * @param props \r\n * state from father:   props.tcOptions_settingModal,\r\n * state from father & need to back:    awardOptions,memberOptions\r\n * function from father:    handleSettingModal(status),backFromChild\r\n */\r\n\r\nconst SettingModal = (props: any) => {\r\n\r\n    const [awardOptions, setAwardOptions] = useState(props.awardOptions);\r\n    const [memberOptions, setMemberOptions] = useState(props.memberOptions);\r\n    const [activePane, setActivePane] = useState(\"1\");\r\n    const [upLoadStatus, setUpLoadStatus] = useState(\"0\")\r\n\r\n    const awardColumns: any = [\r\n        {\r\n            dataIndex: 'awardlevel',\r\n            title: '奖品等级',\r\n            render: (text: any, record: any, index: any) => <Input value={text}\r\n                onChange={(e) => updateInputValue(\"awardOptions\", \"awardlevel\", index, e.target.value)} />\r\n\r\n        },\r\n        {\r\n            dataIndex: 'awardname',\r\n            title: '奖品名称',\r\n            render: (text: any, record: any, index: any) => <Input value={text}\r\n                onChange={(e) => updateInputValue(\"awardOptions\", \"awardname\", index, e.target.value)} />\r\n        },\r\n        {\r\n            dataIndex: 'awardnum',\r\n            title: '奖品数量',\r\n            render: (text: any, record: any, index: any) => <InputNumber value={text}\r\n                min={0}\r\n                onChange={(value) => updateInputValue(\"awardOptions\", \"awardnum\", index, value)} />\r\n        },\r\n        {\r\n            dataIndex: '操作',\r\n            title: '删除',\r\n            render: (text: any, record: any, index: any) => <Button type=\"primary\" danger\r\n                onClick={() => setAwardOptions(Object.assign({}, awardOptions, {\r\n                    awards: awardOptions.awards.filter((item: any) => item.key !== record.key)\r\n                }))}>\r\n                删除\r\n          </Button>\r\n        }\r\n    ]\r\n    const palyerColumns: any = [\r\n        {\r\n            dataIndex: 'usercode',\r\n            title: '编号',\r\n            render: (text: any, record: any, index: any) => <Input value={text}\r\n                onChange={(e) => updateInputValue(\"memberOptions\", \"usercode\", index, e.target.value)} />\r\n        },\r\n        {\r\n            dataIndex: 'username',\r\n            title: '姓名',\r\n            render: (text: any, record: any, index: any) => <Input value={record.username}\r\n                onChange={(e) => updateInputValue(\"memberOptions\", \"username\", index, e.target.value)} />\r\n        },\r\n        {\r\n            dataIndex: '操作',\r\n            title: '删除',\r\n            render: (text: any, record: any, index: any) => <Button type=\"primary\" danger\r\n                onClick={() => setMemberOptions(Object.assign({}, memberOptions, {\r\n                    members: memberOptions.members.filter((item: any) => item.key !== record.key)\r\n                }))}>\r\n                删除\r\n          </Button>\r\n        }\r\n    ]\r\n\r\n    const updateInputValue = (statename: any, dataIndex: any, rowindex: any, value: any) => {\r\n        if (statename === \"memberOptions\") {\r\n            let new_memberOptions = JSON.parse(JSON.stringify(memberOptions));\r\n            new_memberOptions.members[rowindex][dataIndex] = value\r\n\r\n            let repeat_flag = false;\r\n            if (dataIndex === \"usercode\" || dataIndex === \"username\") {\r\n                let exist_comb: any = [];\r\n                new_memberOptions.members.map((item: any) => {\r\n                    exist_comb.push(item.usercode + \"_\" + item.username)\r\n                })\r\n                repeat_flag = JSON.stringify(Array.from(new Set(exist_comb))) !== JSON.stringify(exist_comb)\r\n            }\r\n\r\n            if (repeat_flag) {\r\n                message.warning(\"不允许出现“编号+姓名”名称完全一致的行\", 5)\r\n            } else {\r\n\r\n\r\n                setMemberOptions(new_memberOptions)\r\n            }\r\n        } else if (statename === \"awardOptions\") {\r\n            let new_awardOptions = JSON.parse(JSON.stringify(awardOptions));\r\n            new_awardOptions.awards[rowindex][dataIndex] = value\r\n\r\n            if (dataIndex === \"awardnum\") {\r\n                value = Math.floor(value)\r\n            }\r\n\r\n            let repeat_flag = false;\r\n            if (dataIndex === \"awardlevel\" || dataIndex === \"awardname\") {\r\n                let exist_comb: any = [];\r\n                new_awardOptions.awards.map((item: any) => {\r\n                    exist_comb.push(item.awardlevel + \"_\" + item.awardname)\r\n                })\r\n\r\n                repeat_flag = JSON.stringify(Array.from(new Set(exist_comb))) !== JSON.stringify(exist_comb)\r\n            }\r\n            if (repeat_flag) {\r\n\r\n                message.warning(\"不允许出现“奖品等级+奖品名称”名称完全一致的行\", 5)\r\n            } else {\r\n\r\n                setAwardOptions(new_awardOptions)\r\n            }\r\n\r\n        }\r\n    }\r\n    const addRow = (activePane: any) => {\r\n        if (activePane === \"1\") {\r\n            let data = awardOptions.awards;\r\n            let newkey = data.length ? `${Number(data[data.length - 1].key) + 1}` : \"1\";\r\n            setAwardOptions(Object.assign({}, awardOptions, {\r\n                awards: awardOptions.awards.concat({ awardlevel: \"\", awardname: \"\", awardnum: 0, key: newkey })\r\n            }))\r\n        } else if (activePane === \"2\") {\r\n            let data = memberOptions.members;\r\n            let newkey = data.length ? `${Number(data[data.length - 1].key) + 1}` : \"1\";\r\n            setMemberOptions(Object.assign({}, memberOptions, {\r\n                members: memberOptions.members.concat({ usercode: \"\", username: \"\", key: newkey })\r\n            }))\r\n        }\r\n    }\r\n\r\n    const addMemberFromFile = (e_target: any) => {\r\n        // (importExcel(e_target) as Promise<any>).then((addMembers: any) => {\r\n        importExcel(e_target).then((addMembers: any) => {\r\n            if (addMembers && addMembers?.length) {\r\n\r\n                let usercode_arr = addMembers.map((item: any) => item.usercode);\r\n                if (JSON.stringify(Array.from(new Set(usercode_arr))) !== JSON.stringify(usercode_arr)) {\r\n                    message.warning(\"excel中有重复的编号\", 5)\r\n                    setUpLoadStatus(\"2\")\r\n\r\n                } else {\r\n                    let new_memberOptions = JSON.parse(JSON.stringify(memberOptions));\r\n                    const prev_member = new_memberOptions.members\r\n                    let newkey = prev_member.length ? `${Number(prev_member.slice(-1)[0].key) + 1}` : \"1\";\r\n\r\n                    let exist_comb_record: any = {};//形如 [{'1_甲':number}]\r\n                    prev_member.map((item: any) => {\r\n\r\n                        exist_comb_record[item.usercode + \"_\" + item.username] = 1\r\n                    })\r\n\r\n\r\n                    let new_exist_comb_record = JSON.parse(JSON.stringify(exist_comb_record))\r\n                    // console.log(new_exist_comb_record)\r\n\r\n                    //下面代码除了添加每行excel新数据到旧state中，仅在若新旧数据的comb完全一致，新数据的名字后面加个(n+1)\r\n                    addMembers.map((item: any) => {\r\n                        let new_comb = item.usercode + \"_\" + item.username;\r\n\r\n\r\n                        if (new_exist_comb_record[new_comb]) {\r\n                            console.log(\"进来\")\r\n                            new_exist_comb_record[new_comb] += 1;\r\n                            //同名出现n+1次 则 改为 名字(n+1)\r\n                            new_memberOptions.members.push({\r\n                                usercode: item.usercode,\r\n                                username: `${item.username}(${new_exist_comb_record[item.usercode + \"_\" + item.username]})`,\r\n                                key: newkey\r\n                            })\r\n                            newkey = `${Number(newkey) + 1}`;\r\n                        } else {\r\n\r\n\r\n                            new_exist_comb_record[new_comb] = 1\r\n                            new_memberOptions.members.push({\r\n                                usercode: item.usercode,\r\n                                username: item.username,\r\n                                key: newkey\r\n                            })\r\n\r\n\r\n                            newkey = `${Number(newkey) + 1}`;\r\n                        }\r\n\r\n                    });\r\n\r\n\r\n                    setUpLoadStatus(\"1\")\r\n                    setMemberOptions(new_memberOptions)\r\n                }\r\n\r\n\r\n\r\n\r\n            }\r\n        })\r\n            .catch((e: any) => {\r\n                setUpLoadStatus(\"2\")\r\n                console.log(\"异常\")\r\n                console.log(e)\r\n            })\r\n\r\n    }\r\n\r\n    return <Modal title=\"抽奖设置\" style={{ paddingTop: 8 }}\r\n        visible={props.tcOptions_settingModal}\r\n        onCancel={() => props.handleSettingModal(false)}\r\n        footer={[\r\n            <Button key=\"1\" onClick={() => props.handleSettingModal(false)}>\r\n                取消\r\n            </Button>,\r\n            <Button key=\"2\" danger onClick={() => props.backFromChild(awardOptions, memberOptions, true)}>\r\n                修改并重置\r\n            </Button>,\r\n            <Button key=\"3\" type=\"primary\" onClick={() => props.backFromChild(awardOptions, memberOptions, false)}>\r\n                修改不重置\r\n            </Button>\r\n        ]}\r\n    >\r\n        <Tabs activeKey={activePane} onChange={(activeKey) => setActivePane(activeKey)}\r\n            tabBarExtraContent={[\r\n                <Button onClick={() => addRow(activePane)} key=\"2\" style={{ marginRight: 4 }}>\r\n                    <PlusCircleOutlined\r\n                        style={{ display: \"inline-grid\", placeItems: \"center\" }} />增加行</Button>,\r\n                <Button key=\"3\" danger type=\"primary\"\r\n                    onClick={() => setMemberOptions(Object.assign({}, memberOptions, {\r\n                        members: []\r\n                    }))}>清空人员</Button>\r\n            ]}>\r\n            <TabPane tab=\"奖品\" key=\"1\">\r\n                <Table\r\n                    columns={awardColumns}\r\n                    dataSource={awardOptions.awards}\r\n                    rowKey={(record) => record.key}\r\n                    pagination={false}></Table>\r\n            </TabPane>\r\n            <TabPane tab=\"人员\" key=\"2\">\r\n                <Tooltip title={\"excel第一个工作表中左顶格[编号]和[姓名]两列\"}>\r\n                    <input\r\n                        type='file'\r\n                        accept='.xlsx, .xls' style={{ display: \"inline-block\", width: \"auto\" }} onChange={(e) => {\r\n                            e.persist()\r\n                            addMemberFromFile(e.target)\r\n                            e.target.value = \"\"//解决重复文件上传不触发onChange\r\n                        }} />\r\n                </Tooltip>\r\n                {upLoadStatus === \"1\" ?\r\n                    <span style={{ color: \"green\" }}>上传成功</span>\r\n                    : upLoadStatus === \"2\" ?\r\n                        <span style={{ color: \"red\" }}>上传失败</span>\r\n                        : null\r\n\r\n                }\r\n                <Table\r\n                    size=\"small\"\r\n                    columns={palyerColumns}\r\n                    dataSource={memberOptions.members}\r\n                    rowKey={(record) => record.key}\r\n                    pagination={false}\r\n                    scroll={{ y: 300 }}></Table>\r\n            </TabPane>\r\n\r\n        </Tabs>\r\n\r\n    </Modal>\r\n}\r\nexport default SettingModal;","import React, { Fragment } from 'react';\r\nimport { HashRouter as Router, Switch, Route, Redirect } from 'react-router-dom';\r\n\r\nimport HomePage from '@pages/HomePage';\r\n// import SettingPage from '@pages/SettingPage';\r\n// import LotteryPage from '@pages/LotteryPage';\r\n\r\n\r\nconst PageMainRouter = (props: any) => <Fragment>\r\n    <Router>\r\n        <Switch>\r\n            <Redirect exact from=\"/\" to=\"/home\" />\r\n            <Route exact path=\"/home\" component={HomePage} />\r\n            {/* 不分页面了，直接一个页面里解决 */}\r\n            {/* <Route exact path=\"/setting\" component={SettingPage} />\r\n            <Route exact path=\"/lottery\" component={LotteryPage} />\r\n            <Route exact path=\"/demoTailwind\" component={DemoTailwindPage} /> */}\r\n        </Switch>\r\n    </Router>\r\n\r\n</Fragment>\r\n\r\nexport default PageMainRouter","import React from 'react';\r\nimport PageMainRouter from '@pages/router'\r\n\r\nimport './App.less';\r\n\r\nfunction App() {\r\n  return (\r\n    <PageMainRouter />\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      process.env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  //   <App />\r\n  // </React.StrictMode>,\r\n  <App />,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","import { resolve } from 'dns';\r\nimport XLSX from 'xlsx';\r\n\r\nexport const importExcel = (e_target: any) => new Promise((resolve: (value: any) => void) => {\r\n    let wb;// 读取完成的数据  \r\n    // 导入 \r\n\r\n    if (!e_target.files) {\r\n        resolve(false);\r\n    }\r\n    const firstfile = e_target.files[0];\r\n\r\n    //文件读取   \r\n    const reader = new FileReader();\r\n    reader.onload = function (e: any) {\r\n        const data = e.target.result;\r\n        //将文件读取为二进制字符串  \r\n        wb = XLSX.read(data, { type: 'binary' });\r\n\r\n\r\n        // console.log(wb.SheetNames[0]);// wb.SheetNames[0]是获取Sheets中第一个Sheet的名字\r\n        // wb.Sheets[Sheet名]获取第一个Sheet的数据\r\n\r\n        let josonarray = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]])\r\n\r\n\r\n        if (josonarray) {\r\n\r\n\r\n            josonarray = josonarray.map((item: any) => {\r\n                if (item[\"编号\"] && item[\"姓名\"]) {\r\n\r\n                    return { usercode: item[\"编号\"], username: item[\"姓名\"] }\r\n                }\r\n            });\r\n            // console.log(JSON.stringify(josonarray));\r\n\r\n            resolve(josonarray);\r\n        } else {\r\n            resolve(false);\r\n        }\r\n\r\n    };\r\n    reader.readAsBinaryString(firstfile);\r\n})\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const exportExcel = (export_json: any) => {\r\n\r\n\r\n\r\n\r\n    let SheetNames_array: any = [];\r\n    Object.keys(export_json).map((awardlevel: any) => {\r\n        SheetNames_array.push(awardlevel)\r\n        export_json[awardlevel] = export_json[awardlevel].map((item: any) => ({ \"编号\": item.usercode, \"姓名\": item.username }))\r\n        export_json[awardlevel] = XLSX.utils.json_to_sheet(export_json[awardlevel]);\r\n    })\r\n    const wb = { SheetNames: SheetNames_array, Sheets: export_json, Props: {} };\r\n\r\n\r\n    const str = XLSX.write(wb, {\r\n        bookType: 'xlsx', // 输出的文件类型\r\n        type: 'buffer', // 输出的数据类型\r\n        compression: true // 开启zip压缩\r\n    });\r\n\r\n    const buffer = new ArrayBuffer(str.length);\r\n    let view = new Uint8Array(buffer);\r\n    for (var i = 0; i != str.length; ++i) view[i] = str.charCodeAt(i) & 0xFF;\r\n\r\n    const e = document.createElement('a');\r\n    e.download = \"中奖结果.xlsx\";\r\n    e.style.display = 'none';\r\n\r\n    var blob = new Blob([buffer], { type: \"application/octet-stream\" });\r\n    e.href = URL.createObjectURL(blob);\r\n\r\n    document.body.appendChild(e);\r\n\r\n    e.click();\r\n\r\n    document.body.removeChild(e);\r\n}\r\n\r\nexport const downloadTemplate = () => {\r\n\r\n\r\n    const wb = {\r\n        SheetNames: [\"抽奖名单\"], Sheets: {\r\n            \"抽奖名单\": XLSX.utils.json_to_sheet([{ \"编号\": \"\", \"姓名\": \"\" }])\r\n        }, Props: {}\r\n    };\r\n\r\n\r\n    const str = XLSX.write(wb, {\r\n        bookType: 'xlsx', // 输出的文件类型\r\n        type: 'buffer', // 输出的数据类型\r\n        compression: true // 开启zip压缩\r\n    });\r\n\r\n    const buffer = new ArrayBuffer(str.length);\r\n    let view = new Uint8Array(buffer);\r\n    for (var i = 0; i != str.length; ++i) view[i] = str.charCodeAt(i) & 0xFF;\r\n\r\n    const e = document.createElement('a');\r\n    e.download = \"抽奖名单模板.xlsx\";\r\n    e.style.display = 'none';\r\n\r\n    var blob = new Blob([buffer], { type: \"application/octet-stream\" });\r\n    e.href = URL.createObjectURL(blob);\r\n\r\n    document.body.appendChild(e);\r\n\r\n    e.click();\r\n\r\n    document.body.removeChild(e);\r\n}\r\n"],"sourceRoot":""}